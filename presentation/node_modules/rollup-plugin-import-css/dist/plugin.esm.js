/* Copyright (c) 2021 Outwalk Studios */
import{createFilter as e}from"@rollup/pluginutils";import r from"fs";import t from"path";export default(n={})=>{n.transform||(n.transform=e=>e);const a=n.alwaysOutput||!1,s=[],i=["**/*.css"].concat(n.include||[]),o=e(i,n.exclude||[]);return{name:"import-css",load(e){if(o(e))return r.readFileSync(e,"utf8")},transform(e,r){if(!o(r))return;const t=n.minify?n.transform(e).replace(/\/\*(?:(?!\*\/)[\s\S])*\*\/|[\r\n\t]+/g,"").replace(/ {2,}/g," ").replace(/ ([{:}]) /g,"$1").replace(/([{:}]) /g,"$1").replace(/([;,]) /g,"$1").replace(/ !/g,"!"):n.transform(e);return s[r]=t,{code:`export default ${JSON.stringify(t)};`,map:{mappings:""}}},generateBundle(e,r){for(let i in r){let o=Array.isArray(r[i].modules)?r[i].modules:Object.getOwnPropertyNames(r[i].modules),l=Object.entries(s).sort(((e,r)=>o.indexOf(e[0])-o.indexOf(r[0]))).map((e=>{if(!r[i].modules[e[0]])return e[1]})).join("\n");if(l.trim().length<=0&&!a)return;const m=n.output||t.join(t.dirname(e.file),t.basename(i,t.extname(e.file))+".css");this.emitFile({type:"asset",fileName:m,source:l})}}}};
